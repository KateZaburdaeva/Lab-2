import csv

def open_books():
    with open('books.csv', newline='', encoding='UTF 8') as fh: 
        reader = csv.reader(fh, delimiter=';', quotechar='"')
        books = [row for row in reader]
    return books[1:]



def search_author():
    author = input("Введите автора:")
    for book in books:
        if (book[4]==author or book[3]==author) and float(book[7]) < 150:
            print (book[3], book[1], f'цена: {book[7]}')



books = open_books()
search_author() 